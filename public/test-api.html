<!--public/test-api.html-->
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>API Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #00ff00;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
            background: #d4af37;
            border: none;
            border-radius: 5px;
        }
        #result {
            background: #000;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #d4af37;
            white-space: pre-wrap;
            font-size: 14px;
        }
        .success { color: #4bfb1f; }
        .error { color: #ff4444; }
    </style>
</head>
<body>
    <h1>ğŸ” VELORA API Test Paneli</h1>
    
    <h2>Test ButonlarÄ±:</h2>
    <button onclick="testAuthRoute()">1. Auth Route Test</button>
    <button onclick="testRegister()">2. Register Test</button>
    <button onclick="testLogin()">3. Login Test (User)</button>
    <button onclick="testLoginAdmin()">4. Login Test (Admin)</button>
    <button onclick="testProducts()">5. Products Test</button>
    
    <div id="result"></div>

    <script>
        const resultDiv = document.getElementById('result');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            resultDiv.innerHTML += `<div class="${color}">[${timestamp}] ${message}</div>`;
        }

        async function testAuthRoute() {
            resultDiv.innerHTML = '';
            log('ğŸ§ª Auth route test baÅŸlatÄ±ldÄ±...');
            
            try {
                const res = await fetch('/api/auth/test');
                const data = await res.json();
                
                if (res.ok) {
                    log('âœ… Auth route Ã§alÄ±ÅŸÄ±yor!', 'success');
                    log(JSON.stringify(data, null, 2), 'success');
                } else {
                    log('âŒ Auth route yanÄ±t verdi ama hatalÄ±', 'error');
                    log(JSON.stringify(data, null, 2), 'error');
                }
            } catch (err) {
                log('âŒ Auth route ERÄ°ÅÄ°LEMÄ°YOR!', 'error');
                log(err.message, 'error');
            }
        }

        async function testRegister() {
            resultDiv.innerHTML = '';
            log('ğŸ§ª Register test baÅŸlatÄ±ldÄ±...');
            
            const testUser = {
                name: 'testuser' + Math.floor(Math.random() * 1000),
                email: 'test' + Math.floor(Math.random() * 1000) + '@test.com',
                password: '123456',
                role: 'user'
            };
            
            log('ğŸ“¤ GÃ¶nderilen veri: ' + JSON.stringify(testUser, null, 2));
            
            try {
                const res = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testUser)
                });
                
                const data = await res.json();
                
                if (res.ok) {
                    log('âœ… KayÄ±t baÅŸarÄ±lÄ±!', 'success');
                    log(JSON.stringify(data, null, 2), 'success');
                } else {
                    log(`âš ï¸ KayÄ±t baÅŸarÄ±sÄ±z (${res.status})`, 'error');
                    log(JSON.stringify(data, null, 2), 'error');
                }
            } catch (err) {
                log('âŒ Register endpoint ERÄ°ÅÄ°LEMÄ°YOR!', 'error');
                log(err.message, 'error');
            }
        }

        async function testLogin() {
            resultDiv.innerHTML = '';
            log('ğŸ§ª Login test baÅŸlatÄ±ldÄ± (User)...');
            
            const loginData = {
                usernameOrEmail: 'test@test.com',
                password: '123456',
                role: 'user'
            };
            
            log('ğŸ“¤ GÃ¶nderilen veri: ' + JSON.stringify(loginData, null, 2));
            
            try {
                const res = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(loginData)
                });
                
                const data = await res.json();
                
                if (res.ok) {
                    log('âœ… Login baÅŸarÄ±lÄ±!', 'success');
                    log(JSON.stringify(data, null, 2), 'success');
                } else {
                    log(`âš ï¸ Login baÅŸarÄ±sÄ±z (${res.status})`, 'error');
                    log(JSON.stringify(data, null, 2), 'error');
                }
            } catch (err) {
                log('âŒ Login endpoint ERÄ°ÅÄ°LEMÄ°YOR!', 'error');
                log(err.message, 'error');
            }
        }

       async function testLoginAdmin() {
    log('ğŸ§ª Admin login testi baÅŸlatÄ±ldÄ±...');
    try {
        const res = await fetch('/api/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                usernameOrEmail: "admin@velora.com",
                password: "admin123",
                role: "admin"
            })
        });

        const data = await res.json();
        
        if (data.success) {
            log('âœ… Admin login BAÅARILI!', 'success');
            log(JSON.stringify(data, null, 2));
            
            log('â„¹ï¸ Not: Test panelinde olduÄŸunuz iÃ§in admin.html sayfasÄ±na otomatik yÃ¶nlendirme yapÄ±lmadÄ±.');
        } else {
            log('âš ï¸ Admin login BAÅARISIZ!', 'error');
            log(JSON.stringify(data, null, 2));
        }
    } catch (err) {
        log('âŒ HATA: ' + err.message, 'error');
    }
}

        async function testProducts() {
            resultDiv.innerHTML = '';
            log('ğŸ§ª Products test baÅŸlatÄ±ldÄ±...');
            
            try {
                const res = await fetch('/api/products');
                const data = await res.json();
                
                if (res.ok) {
                    log('âœ… Products endpoint Ã§alÄ±ÅŸÄ±yor!', 'success');
                    log(`Toplam ${data.length} Ã¼rÃ¼n bulundu`, 'success');
                } else {
                    log('âš ï¸ Products hatalÄ± yanÄ±t', 'error');
                    log(JSON.stringify(data, null, 2), 'error');
                }
            } catch (err) {
                log('âŒ Products endpoint ERÄ°ÅÄ°LEMÄ°YOR!', 'error');
                log(err.message, 'error');
            }
        }

        window.onload = () => {
            log('ğŸš€ Test paneli hazÄ±r!');
            log('ğŸ’¡ Ä°pucu: Ã–nce "Auth Route Test" butonuna tÄ±klayÄ±n');
        };
    </script>
</body>
</html>